<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–õ–æ—Ç–µ—Ä–µ—è</title>
<style>
  body { font-family: Arial, sans-serif; background: #f0f0f0; margin: 20px; }
  h1 { text-align: center; }
  .boxes { display: flex; flex-wrap: wrap; max-width: 440px; margin: 20px auto; gap: 10px; }
  .box {
    width: 100px; height: 100px;
    background: #ddd; border-radius: 8px;
    display: flex; justify-content: center; align-items: center;
    cursor: pointer; user-select: none;
    font-weight: bold; font-size: 18px;
    transition: background 0.3s;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  }
  .box.locked {
    background: #bbb;
    cursor: default;
    color: #555;
    box-shadow: none;
  }
  .message {
    text-align: center; margin-top: 20px;
    font-size: 22px;
    font-weight: 700;
    color: #2c3e50;
  }
</style>
</head>
<body>
  <h1>–õ–æ—Ç–µ—Ä–µ—è: –≤—ã–±–µ—Ä–∏ –∫–æ—Ä–æ–±–∫—É</h1>
  <div class="boxes" id="boxes"></div>
  <div class="message" id="message"></div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script>
    // –¢–≤–æ–π –∫–æ–Ω—Ñ–∏–≥ Firebase (—Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º databaseURL)
    const firebaseConfig = {
      apiKey: "AIzaSyBH_yHOUz5av_t0pow6J6PnzfbnJQ5KI3Y",
      authDomain: "lottery-game-2ed99.firebaseapp.com",
      databaseURL: "https://lottery-game-2ed99-default-rtdb.firebaseio.com",
      projectId: "lottery-game-2ed99",
      storageBucket: "lottery-game-2ed99.firebasestorage.app",
      messagingSenderId: "342594862502",
      appId: "1:342594862502:web:88461096c3c1727fa0a367"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const boxesContainer = document.getElementById('boxes');
    const messageEl = document.getElementById('message');

    const totalBoxes = 10;
    const prizeBoxes = [2, 5, 8]; // –ø—Ä–∏–∑—ã –≤ –∫–æ—Ä–æ–±–∫–∞—Ö
    const prizeNames = {
      2: "–ê–≤–∞—Ç–∞—Ä–∫–∞",
      5: "–ü–ª–∞—à–∫–∞",
      8: "–¢–∞–±–ª–∏—á–∫–∞"
    };

    let boxesState = {};

    function loadState() {
      db.ref('lottery/boxes').once('value').then(snapshot => {
        boxesState = snapshot.val() || {};
        renderBoxes();
      }).catch(() => {
        boxesState = {};
        renderBoxes();
      });
    }

    function saveChoice(index, result) {
      const update = {};
      update['lottery/boxes/' + index] = result;
      db.ref().update(update);
    }

    function renderBoxes() {
      boxesContainer.innerHTML = '';
      for(let i=0; i<totalBoxes; i++) {
        const box = document.createElement('div');
        box.className = 'box';
        if (boxesState[i]) {
          box.textContent = boxesState[i] === 'win' ? 'üéÅ' : '‚ùå';
          box.classList.add('locked');
        } else {
          box.textContent = '?';
          box.addEventListener('click', () => {
            if (boxesState[i]) return;
            const isWin = prizeBoxes.includes(i);
            const result = isWin ? 'win' : 'miss';
            boxesState[i] = result;
            saveChoice(i, result);
            renderBoxes();
            showMessage(isWin ? `–£—Ä–∞, —Ç—ã –≤—ã–±–∏–ª: ${prizeNames[i]}` : "–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –º–∏–º–æ");
          });
        }
        boxesContainer.appendChild(box);
      }
    }

    function showMessage(text) {
      messageEl.textContent = text;
      setTimeout(() => { messageEl.textContent = ''; }, 4000);
    }

    loadState();
  </script>
</body>
</html>
